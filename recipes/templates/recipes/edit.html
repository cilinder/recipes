{% extends "recipes/base.html" %}

{% block content %}
<h2 class="text-5xl font-bold text-center font-serif mb-6">Edit recipe</h2>
<div class="grid grid-cols-1 lg:grid-cols-2 mx-auto lg:w-2/3">
  <div class="lg:w-96 m-4">
    <form action={% url 'update_recipe' recipe.id %} method="post">
      {% csrf_token %}
      <fieldset class="lg:w-96 space-y-2">
        <label for="recipe_name">Recipe name: </label><br>
        <input  class="w-full shadow" type="text" name="recipe_name" value={{ recipe.recipe_name }}><br>
        <label for="duration">Duration [min]: </label><br>
        <input  class="w-full shadow" type="text" name="duration" value={{ recipe.esstimated_duration_minutes }}><br>
        <label for="duration">Ingredients</label><br>
        {% for ingredient in ingredients %}
          <input class="w-full shadow" type="text" name="ing_name_{{ingredient.id}}" value={{ ingredient.name }}>
          <input class="w-full shadow" type="number" name="ing_qty_{{ingredient.id}}" value={{ ingredient.quantity }}>
          <input class="w-full shadow" type="text" name="ing_unit_{{ingredient.id}}" value={{ ingredient.unit }}>
          <br>
        {% endfor %}
        <!-- <textarea name="ingredients", rows=5, cols=50>{{ recipe.ingredients }}</textarea><br> -->
        <label for="instructions">Instructions</label><br>
        <textarea class="w-full shadow" name="instructions">{{ recipe.instructions }}</textarea><br>
        {% if img_obj %}  
          <input type="hidden" name="image" value={{img_obj.id}}><br>
        {% endif %}
      </fieldset>
      <input class="btn btn-blue shadow-md" type="submit" value="Save">
      <button class="btn btn-blue shadow-md mt-4"><a href="{% url 'index' %}">Back</a></button>
    </form>
  </div>
  <div class="lg:w-96 m-4">
    <h2>Upload an image of your recipe</h2>
    <form action={% url 'edit_recipe' recipe.id %} method="post" enctype="multipart/form-data">
      {% csrf_token %}  
      {{ form.as_p }}
      <button class="btn btn-blue shadow-md" type="submit">Upload</button>
    </form>
    
    {% if img_obj %}
      <h3>Succesfully uploaded : {{img_obj.caption}}</h3>
      <img src="{{ img_obj.image.url}}" alt="connect" style="max-height:300px">
    {% elif recipe.image %}
      <h3>Image: {{recipe.image.caption}}</h3>
      <img src="{{ recipe.image.image.url}}" alt="image not found" style="max-height:200px">  
    {% endif %}
  </div>
</div>

{% endblock %}

